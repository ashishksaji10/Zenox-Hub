<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="Male_Fashion Template">
    <meta name="keywords" content="Male_Fashion, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ZenoX Hub</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&display=swap"
    rel="stylesheet">

    <!-- Css Styles -->
    <link rel="stylesheet" href="assets/css/vendor/vendor.min.css">
    <!-- <link rel="stylesheet" href="assets/css/plugins/plugins.min.css"> -->
    <link rel="stylesheet" href="assets/css/style.min.css">

    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="css/elegant-icons.css" type="text/css">
    <link rel="stylesheet" href="css/magnific-popup.css" type="text/css">
    <link rel="stylesheet" href="css/nice-select.css" type="text/css">
    <link rel="stylesheet" href="css/owl.carousel.min.css" type="text/css">
    <link rel="stylesheet" href="css/slicknav.min.css" type="text/css">
    <link rel="stylesheet" href="css/style.css" type="text/css">
    <style>
        .custom-black-background {
    background-color: black;
    color: white; /* Optionally, set text color to contrast with the black background */
}

    </style>
</head>

<body>
    <!-- Page Preloder -->
    <div id="preloder">
        <div class="loader"></div>
    </div>

    <!-- Offcanvas Menu Begin -->
    <div class="offcanvas-menu-overlay"></div>
    <div class="offcanvas-menu-wrapper">
        <div class="offcanvas__option">
            <div class="offcanvas__links">
                <a href="#">Sign in</a>
                <a href="#">FAQs</a>
            </div>
            <div class="offcanvas_top_hover">
                <span>Usd <i class="arrow_carrot-down"></i></span>
                <ul>
                    <li>USD</li>
                    <li>EUR</li>
                    <li>USD</li>
                </ul>
            </div>
        </div>
        <div class="offcanvas_nav_option">
            <a href="#" class="search-switch"><img src="img/icon/search.png" alt=""></a>
            <a href="#"><img src="img/icon/heart.png" alt=""></a>
            <a href="#"><img src="img/icon/cart.png" alt=""> <span>0</span></a>
            <div class="price">$0.00</div>
        </div>
        <div id="mobile-menu-wrap"></div>
        <div class="offcanvas__text">
            <p>Free shipping, 30-day return or refund guarantee.</p>
        </div>
    </div>
    <!-- Offcanvas Menu End -->

    <!-- Header Section Begin -->
    <header class="header">
        <div class="header__top">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-md-7">
                        <div class="header__top__left">
                            <p>Free shipping, 30-day return or refund guarantee.</p>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-5">
                        <div class="header__top__right">
                            <div class="header__top__links">
                                <a href="/user-profile">Profile</a>
                                <a href="/logout">LogOut</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-3">
                    <div class="header__logo">
                        <h3><strong>ZenoX Hub</strong></h3>
                        
                    </div>
                </div>
                <div class="col-lg-6 col-md-6">
                    <nav class="header__menu mobile-menu">
                        <ul>
                            <li class="active"><a href="/home">Home</a></li>
                            <li><a href="/shop">Shop</a></li>
                            <li><a href="/contact">Contacts</a></li>
                        </ul>
                    </nav>
                </div>
                <div class="col-lg-3 col-md-3">
                    <div class="header__nav__option">
                        <a href="/wishlist"><img src="img/icon/heart.png" alt=""></a>
                        <a href="/cart"><img src="img/icon/cart.png" alt=""> <span>0</span></a>
                    </div>
                </div>
            </div>
            <div class="canvas__open"><i class="fa fa-bars"></i></div>
        </div>
    </header>
    <!-- Header Section End -->

    <!-- Breadcrumb Section Begin -->
    <section class="breadcrumb-option">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="breadcrumb__text">
                        <h4>Check Out</h4>
                        <div class="breadcrumb__links">
                            <a href="/home">Home</a>
                            <a href="/shop">Shop</a>
                            <a href="/cart">Cart</a>
                            <span>Check Out</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcrumb Section End -->

    <!-- Checkout Section Begin -->
    <section class="checkout spad">
        <p class="message" style="text-align: center; color: red;">
            <% if (typeof message !== "undefined") { %>
                <%= message %>
            <% } %>
        <div class="checkout-section">
            <form action="" method="post">
                <div class="container">
                    <div class="checkout_form" data-aos="fade-up" data-aos-delay="400">
                        <div class="row">
                            <div class="col-lg-6 col-md-6">
                                <h3 class="card-title"></h3>
                                <div class="card mb-2">
                                    <div class="card-body" style="display: flex; align-items: center;">
                                        
                                        <div class="address-details">
                                            <p class="card-text">
                                                <% if (address && address.addresses && address.addresses.length) { %>
                                                    <% address.addresses.forEach((addr, index) => { %>
                                                        <div class="card mb-2">
                                                            <div class="card-body" style="display: flex; align-items: center;">
                                                                <div class="address-radio" style="margin-right: 10px;">
                                                                    <input type="radio" name="address" value="<%= addr.addressType %>" id="address<%= index %>" style="margin-top: 6px;" />
                                                                    <label for="address<%= index %>"></label>
                                                                </div>
                                                                <div class="address-details">
                                                                    <p class="card-text">
                                                                        <%= addr.houseNo %>,
                                                                        <%= addr.landmark %>,
                                                                        <%= addr.street %>,
                                                                        <%= addr.city %>,
                                                                        <%= addr.district %>,
                                                                        <%= addr.country %>,
                                                                        Pincode-<%= addr.pincode %>
                                                                    </p>
                                                                    <a href="/edit-address?addressType=<%= addr.addressType %>&&id=1" class="btn btn-md btn-black-default-hover custom-black-background">Edit</a>
                                                                    <a href="/delete-address?addressType=<%= addr.addressType %>&&id=1" class="btn btn-md btn-black-default-hover custom-black-background">Remove</a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    <% }); %>
                                                <% } else { %>
                                                    <p>Please Add address</p>
                                                <% } %>
                                        </div>
                                    </div>
                                </div>
                                <p>Please Add address</p>
                                <a href="/add-address?id=1" class="btn btn-md btn-black-default-hover custom-black-background">Add Address</a>
                            </div>
                            <div class="col-lg-6 col-md-6">
                                <h3>Your order</h3>
                                <div class="order_table table-responsive">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Product</th>
                                                <th>Quantity</th>
                                                <th>Price</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <% if (cart && cart.items && cart.items.length) { %>
                                                <% cart.items.forEach((item) => { %>
                                                    <tr>
                                                        <td class="product_name"><a href="/shop-details?productid=<%= item.ProductId._id %>" style="color: red;"><%= item.ProductId.name %></a></td>
                                                        <td class="product_total" id=""><%= item.quantity %></td>
                                                        <td class="product_total" id="carttotal">Rs.<%= item.price %>.00</td>
                                                        
                                                    </tr>
                                                <% }); %>
                                            <% } else { %>
                                                <tr>
                                                    <td colspan="2">No items in the cart.</td>
                                                </tr>
                                            <% } %>
                                        </tbody>
                                        
                                        <tfoot>
                                            <% let totalSum = 0; %>
                                            <% cart.items.forEach((item) => { %>
                                                <% totalSum += item.quantity * item.price; %>
                                            <% }); %>
                                            <tr class="order_total">
                                                <th>Sub Total</th>
                                                <td name="amount"><strong>&nbsp;Rs.<%= totalSum %>.00</strong></td>
                                                <td><strong></strong></td>
                                            </tr>
                                            <tr>
                                                <th>Discounted Amounted</th>
                                                <td style="color: #999;">
                                                    <strong>
                                                        <span style="white-space: nowrap;">-Rs.<%= (totalSum - cart.billTotal) %>.00</span>
                                                    </strong>
                                                </td>
                                                <td><strong></strong></td>
                                            </tr>
                                            <tr class="order_total">
                                                <th>Order Total</th>
                                                <td name="amount"><strong>&nbsp;Rs.<%= cart.billTotal %>.00</strong></td>
                                                <td><strong></strong></td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                                <div class="payment_method">
                                    <div class="panel-default">
                                        <label class="checkbox-default" for="currencyCod" data-bs-toggle="collapse" data-bs-target="#methodCod">
                                            <input type="radio" id="currencyCod" value="COD" name="paymentOption">
                                            <span>Cash on Delivery</span>
                                        </label>
                                        <label class="checkbox-default ml-5" for="currencyCod" data-bs-toggle="collapse" data-bs-target="#methodCod">
                                            <input type="radio" id="" value="razorpay" name="paymentOption">
                                            <span>Razorpay</span>
                                        </label>
                                        <% if (cart.billTotal <= wallet.amount) { %>
                                        <label class="checkbox-default ml-5" for="currencyCod" data-bs-toggle="collapse" data-bs-target="#methodCod">
                                            <input type="radio" id="" value="wallet" name="paymentOption">
                                            <span>Wallet</span>
                                        </label>
                                        <% } %>
                                        <div id="methodCod" class="collapse" data-parent="#methodCod">
                                            <div class="card-body1">
                                                <p>Please send a check to Store Name, Store Street, Store Town, Store State / County, Store Postcode.</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="order_button pt-3">
                                        <button class="btn btn-md btn-black-default-hover custom-black-background" id="proceedButton" type="submit">Place Order</button>
                                    </div>
                                </div>
                                
                            </div>
                        </div>
                    </div> 
                </div>
            </form>
        </div>
    </section>
    
    <!-- Checkout Section End -->

    <!-- Footer Section Begin -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="footer__about">
                        <div class="footer__logo">
                            <h3 style="color: white;"><strong>ZenoX Hub</strong></h3>
                            <!-- <a href="#"><img src="img/footer-logo.png" alt=""></a> -->
                        </div>
                        <p>The customer is at the heart of our unique business model, which includes design.</p>
                        <a href="#"><img src="img/payment.png" alt=""></a>
                    </div>
                </div>
                <div class="col-lg-2 offset-lg-1 col-md-3 col-sm-6">
                    <div class="footer__widget">
                        <h6>Shopping</h6>
                        <ul>
                            <li><a href="/shop">Men</a></li>
                            <li><a href="/shop">Women</a></li>
                            <li><a href="/shop">Kids</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6">
                    <div class="footer__widget">
                        <h6>About</h6>
                        <ul>
                            <li><a href="/contact">Contact Us</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-3 offset-lg-1 col-md-6 col-sm-6">
                    <div class="footer__widget">
                        <h6>NewLetter</h6>
                        <div class="footer__newslatter">
                            <p>Be the first to know about new arrivals, look books, sales & promos!</p>
                            <form action="#">
                                <input type="text" placeholder="Your email">
                                <button type="submit"><span class="icon_mail_alt"></span></button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12 text-center">
                    <div class="footer__copyright__text">
                        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                        <p>Copyright Â©
                            <script>
                                document.write(new Date().getFullYear());
                            </script>2020
                            All rights reserved | This template is made with <i class="fa fa-heart-o"
                            aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
                        </p>
                        <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer Section End -->
    <!-- Start Modal Add cart -->
    <div class="modal fade" id="modalAddcart" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog  modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col text-right">
                                <button type="button" class="close modal-close" data-bs-dismiss="modal"
                                    aria-label="Close">
                                    <span aria-hidden="true"> <i class="fa fa-times"></i></span>
                                </button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-7">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="modal-add-cart-product-img">
                                            <img class="img-fluid"
                                                src="assets/images/product/default/home-1/default-1.jpg" alt="">
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <div class="modal-add-cart-info"><i class="fa fa-check-square"></i>Added to cart
                                            successfully!</div>
                                        <div class="modal-add-cart-product-cart-buttons">
                                            <a href="cart.html">View Cart</a>
                                            <a href="checkout.html">Checkout</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-5 modal-border">
                                <ul class="modal-add-cart-product-shipping-info">
                                    <li> <strong><i class="icon-shopping-cart"></i> There Are 5 Items In Your
                                            Cart.</strong></li>
                                    <li> <strong>TOTAL PRICE: </strong> <span>$187.00</span></li>
                                    <li class="modal-continue-button"><a href="#" data-bs-dismiss="modal">CONTINUE
                                            SHOPPING</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- End Modal Add cart -->

    <!-- Start Modal Quickview cart -->
    <div class="modal fade" id="modalQuickview" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col text-right">
                                <button type="button" class="close modal-close" data-bs-dismiss="modal"
                                    aria-label="Close">
                                    <span aria-hidden="true"> <i class="fa fa-times"></i></span>
                                </button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="product-details-gallery-area mb-7">
                                    <!-- Start Large Image -->
                                    <div class="product-large-image modal-product-image-large swiper-container">
                                        <div class="swiper-wrapper">
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-1.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-2.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-3.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-4.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-5.jpg" alt="">
                                            </div>
                                            <div class="product-image-large-image swiper-slide img-responsive">
                                                <img src="assets/images/product/default/home-1/default-6.jpg" alt="">
                                            </div>
                                        </div>
                                    </div>
                                    <!-- End Large Image -->
                                    <!-- Start Thumbnail Image -->
                                    <div
                                        class="product-image-thumb modal-product-image-thumb swiper-container pos-relative mt-5">
                                        <div class="swiper-wrapper">
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-1.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-2.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-3.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-4.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-5.jpg" alt="">
                                            </div>
                                            <div class="product-image-thumb-single swiper-slide">
                                                <img class="img-fluid"
                                                    src="assets/images/product/default/home-1/default-6.jpg" alt="">
                                            </div>
                                        </div>
                                        <!-- Add Arrows -->
                                        <div class="gallery-thumb-arrow swiper-button-next"></div>
                                        <div class="gallery-thumb-arrow swiper-button-prev"></div>
                                    </div>
                                    <!-- End Thumbnail Image -->
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="modal-product-details-content-area">
                                    <!-- Start  Product Details Text Area-->
                                    <div class="product-details-text">
                                        <h4 class="title">Nonstick Dishwasher PFOA</h4>
                                        <div class="price"><del>$70.00</del>$80.00</div>
                                    </div> <!-- End  Product Details Text Area-->
                                    <!-- Start Product Variable Area -->
                                    <div class="product-details-variable">
                                        <!-- Product Variable Single Item -->
                                        <div class="variable-single-item">
                                            <span>Color</span>
                                            <div class="product-variable-color">
                                                <label for="modal-product-color-red">
                                                    <input name="modal-product-color" id="modal-product-color-red"
                                                        class="color-select" type="radio" checked>
                                                    <span class="product-color-red"></span>
                                                </label>
                                                <label for="modal-product-color-tomato">
                                                    <input name="modal-product-color" id="modal-product-color-tomato"
                                                        class="color-select" type="radio">
                                                    <span class="product-color-tomato"></span>
                                                </label>
                                                <label for="modal-product-color-green">
                                                    <input name="modal-product-color" id="modal-product-color-green"
                                                        class="color-select" type="radio">
                                                    <span class="product-color-green"></span>
                                                </label>
                                                <label for="modal-product-color-light-green">
                                                    <input name="modal-product-color"
                                                        id="modal-product-color-light-green" class="color-select"
                                                        type="radio">
                                                    <span class="product-color-light-green"></span>
                                                </label>
                                                <label for="modal-product-color-blue">
                                                    <input name="modal-product-color" id="modal-product-color-blue"
                                                        class="color-select" type="radio">
                                                    <span class="product-color-blue"></span>
                                                </label>
                                                <label for="modal-product-color-light-blue">
                                                    <input name="modal-product-color"
                                                        id="modal-product-color-light-blue" class="color-select"
                                                        type="radio">
                                                    <span class="product-color-light-blue"></span>
                                                </label>
                                            </div>
                                        </div>
                                        <!-- Product Variable Single Item -->
                                        <div class="d-flex align-items-center flex-wrap">
                                            <div class="variable-single-item ">
                                                <span>Quantity</span>
                                                <div class="product-variable-quantity">
                                                    <input min="1" max="100" value="1" type="number">
                                                </div>
                                            </div>

                                            <div class="product-add-to-cart-btn">
                                                <a href="#" data-bs-toggle="modal" data-bs-target="#modalAddcart">Add To
                                                    Cart</a>
                                            </div>
                                        </div>
                                    </div> <!-- End Product Variable Area -->
                                    <div class="modal-product-about-text">
                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Mollitia iste
                                            laborum ad impedit pariatur esse optio tempora sint ullam autem deleniti nam
                                            in quos qui nemo ipsum numquam, reiciendis maiores quidem aperiam, rerum vel
                                            recusandae</p>
                                    </div>
                                    <!-- Start  Product Details Social Area-->
                                    <div class="modal-product-details-social">
                                        <span class="title">SHARE THIS PRODUCT</span>
                                        <ul>
                                            <li><a href="#" class="facebook"><i class="fa fa-facebook"></i></a></li>
                                            <li><a href="#" class="twitter"><i class="fa fa-twitter"></i></a></li>
                                            <li><a href="#" class="pinterest"><i class="fa fa-pinterest"></i></a></li>
                                            <li><a href="#" class="google-plus"><i class="fa fa-google-plus"></i></a>
                                            </li>
                                            <li><a href="#" class="linkedin"><i class="fa fa-linkedin"></i></a></li>
                                        </ul>

                                    </div> <!-- End  Product Details Social Area-->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- End Modal Quickview cart -->
    <!-- Search Begin -->
    <div class="search-model">
        <div class="h-100 d-flex align-items-center justify-content-center">
            <div class="search-close-switch">+</div>
            <form class="search-model-form">
                <input type="text" id="search-input" placeholder="Search here.....">
            </form>
        </div>
    </div>
    <!-- Search End -->
    <script>
document.getElementById('proceedButton').addEventListener("click", async (e) => {
    e.preventDefault(); // Prevent form from submitting traditionally

    const selectedAddressType = document.querySelector('input[name="address"]:checked');
    const selectedPaymentOption = document.querySelector('input[name="paymentOption"]:checked');

    if (!selectedAddressType || !selectedPaymentOption) {
        Swal.fire({
            title: 'Attention!',
            text: 'Please select both an address and a payment option.',
            icon: 'warning',
            confirmButtonText: 'OK'
        });
        return;
    }

    const addressType = selectedAddressType.value;
    const paymentOption = selectedPaymentOption.value;
    const bill = document.querySelector('td[name="amount"]')

    const billTotal = bill.textContent||bill.innerText;
    const billValue = billTotal.replace('Rs.','').replace('.00','').trim();
    const amount = parseFloat(billValue)
    const data = { addressType, paymentOption};

    try {
        if(paymentOption == 'COD'){
        const response = await fetch('/confirm-order', {
            method: 'POST', 
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });

        if (response.ok) {
            const responseData = await response.json(); // Assuming the server responds with JSON
            // Handle success. You might want to redirect the user or display a success message
            Swal.fire({
                title: 'Success!',
                text: 'Order placed successfully.',
                icon: 'success',
                confirmButtonText: 'OK'
            }).then((result) => {
                if (result.isConfirmed) {
                    window.location.href = `/confirm-order?id=${responseData.order_id}`; // Redirect to confirmation page, adjust URL as needed
                }
            });
            
        }else if(response.status == 405){
                    Swal.fire({
                    title: 'Error!',
                    text: 'COD Maximum Limit is Rs 1000',
                    icon: 'error',
                    confirmButtonText: 'OK'
                }).then((response)=>{
                    window.location.href = `/checkOut`;
                })
            }}else if (paymentOption == 'razorpay') {
            response = await fetch('/createOrder', {
                method: "POST",
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            if (response.ok) {
                const res = await response.json();
               /// console.log(res,"response----------")
                if (res.success) {
                    const options = {
                        "amount": res.amount,
                        "currency": "INR",
                        "name": "Athlete",
                        "description": "",
                        "image": "http://localhost:3000/user/img/logo2.png",
                        "order_id": res.order_id,
                        "handler":async function (response) {
                            console.log(response,'....................');
                            const data1={response,data}
                           const serverRes=  await fetch('/confirm-order', {
                    method: 'POST', 
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data1)
                            
                            } ) 
                            if (serverRes.ok) {
                    const responseData = await serverRes.json(); // Assuming the server responds with JSON
                    // Handle success. You might want to redirect the user or display a success message
                    Swal.fire({
                        title: 'Success!',
                        text: 'Order placed successfully.',
                        icon: 'success',
                        confirmButtonText: 'OK'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            window.location.href = `/confirm-order?id=${responseData.order_id}`; // Redirect to confirmation page, adjust URL as needed
                        }
                    });
                }  
                            
                        },
                        "prefill": {
                            "contact": res.contact,
                            "name": res.name,
                            "email": res.email
                        },
                        "notes": {
                            "description": ""
                        },
                        "theme": {
                            "color": "#2300a3"
                        }
                    };
                    const razorpayObject = new Razorpay(options);
                    console.log(razorpayObject)
                    razorpayObject.on('payment.failed', function (response) {
                        Swal.fire({
                            title: 'Payment Failed',
                            text: response.error.description || 'An error occurred during payment.',
                            icon: 'error',
                            confirmButtonText: 'OK'
                        }).then(async (error)=>{
                            const data2={data,error}
                             const failRes=await fetch('/confirm-order',{
                                method:'POST',
                                headers:{'Content-Type':'application/json'},
                                body:JSON.stringify(data2)
                             })
                             if (failRes.ok) {
                    const responseData = await failRes.json(); // Assuming the server responds with JSON
                    // Handle success. You might want to redirect the user or display a success message
                    Swal.fire({
                        title: 'Success!',
                        text: 'Order placed successfully.Payment Pending',
                        icon: 'success',
                        confirmButtonText: 'OK'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            window.location.href =`/confirm-order?id=${responseData.order_id}` // Redirect to confirmation page, adjust URL as needed
                        }
                    });
                     }else{
                    Swal.fire({
                        title: 'failed!',
                        text: 'Payment Error',
                        icon: 'error',
                        confirmButtonText: 'OK'
                    })
                }
                        });
                    });
                    razorpayObject.open();
                } else {
                    Swal.fire({
                        title: 'Error!',
                        text: res.msg || 'An error occurred during order creation.',
                        icon: 'error',
                        confirmButtonText: 'OK'
                    });
                }
            }
            }else if(paymentOption == 'wallet'){
                const response = await fetch('/confirm-order', {
                    method: 'POST', 
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    const responseData = await response.json(); // Assuming the server responds with JSON
                    // Handle success. You might want to redirect the user or display a success message
                    Swal.fire({
                        title: 'Success!',
                        text: 'Order placed successfully.',
                        icon: 'success',
                        confirmButtonText: 'OK'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            window.location.href = `/confirm-order?id=${responseData.order_id}`; // Redirect to confirmation page, adjust URL as needed
                        }
                    });
                }else{
                    Swal.fire({
                        title: 'failed!',
                        text: 'Payment Error',
                        icon: 'error',
                        confirmButtonText: 'OK'
                    })
                }
             
                } else {
                const errorData = await response.json();
                Swal.fire({
                    title: 'Error!',
                    text: errorData.msg || 'An error occurred during order creation.',
                    icon: 'error',
                    confirmButtonText: 'OK'
                });
                }
    } catch (error) {
        console.error('Error:', error);
        Swal.fire({
            title: 'Error!',
            text: 'An error occurred during order placement. Please try again.',
            icon: 'error',
            confirmButtonText: 'OK'
        });
    }
});


    </script>
    <script src="assets/js/vendor/vendor.min.js"></script>
    <script src="assets/js/plugins/plugins.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Js Plugins -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <script src="js/jquery.nicescroll.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/jquery.countdown.min.js"></script>
    <script src="js/jquery.slicknav.js"></script>
    <script src="js/mixitup.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/main.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</body>

</html>